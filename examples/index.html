<!DOCTYPE html>
<html lang='en' type="module">
<head>
  <base href=".">
  <meta charset='UTF-8'>
  <title>Orb | Simple graph</title>
  <script type="text/javascript" src="./bundle.js"></script>
</head>
<style>
  html, body {
    height: 100%;
  }
</style>
<body>
  <div id='graph' style="height: 100%"></div>
  <script type="text/javascript">
    const container = document.getElementById('graph');
    // const view = new Orb.DefaultView(container);
    // setTimeout(() => {
    //   document.getElementsByTagName('canvas')[0].getContext('2d').fillRect(0, 0, 400, 400);
    // }, 30)

    const nodes = [
      { id: 0, labels: ['Node A'], properties: { test: 1 }, lat: 10, lng: 10, x: 1, y: 1 },
      { id: 1, labels: ['Node B'], properties: { test: 2 }, lat: 20, lng: 20, x: 2, y: 2 },
      { id: 2, labels: ['Node C'], properties: { test: 3 }, lat: 30, lng: 30, x: 3, y: 3 },
    ]
    const edges = [
      { id: 3, start: 0, end: 0, label: 'Edge Q', properties: { test: 3 } },
      { id: 4, start: 0, end: 1, label: 'Edge W', properties: { test: 3 } },
      { id: 5, start: 0, end: 2, label: 'Edge E', properties: { test: 3 } },
      { id: 6, start: 1, end: 1, label: 'Edge R', properties: { test: 3 } },
      { id: 7, start: 1, end: 2, label: 'Edge T', properties: { test: 3 } },
      { id: 6, start: 2, end: 2, label: 'Edge Y', properties: { test: 3 } },
    ]

    const orb = new Orb.Orb(container);
    orb.setView((context) => new Orb.DefaultView(context, {
      getNodePosition: (node) => ({ x: node.data.x, y: node.data.y, }),
    }))

    // Initialize nodes and edges
    orb.data.setup({ nodes, edges });
    orb.data.setStyle({
      getNodeStyle(node) {
        return {
          borderColor: '#1d1d1d',
          borderWidth: 0.6,
          color: '#DD2222',
          colorHover: '#e7644e',
          colorSelected: '#e7644e',
          fontSize: 3,
          label: node.getLabel(),
          size: 6,
        };
      },
      getEdgeStyle(edge) {
        return {
          color: '#999999',
          colorHover: '#1d1d1d',
          colorSelected: '#1d1d1d',
          fontSize: 3,
          width: 0.3,
          widthHover: 0.9,
          widthSelected: 0.9,
          label: edge.getLabel(),
        };
      },
    });

    // Render and recenter the view
    orb.view.render(() => {
      // orb.view.recenter();
    });

    orb.events.on('node-click', (node) => {
      console.log('Event: node-click', node);
    });
    orb.events.on('node-hover', (node) => {
      console.log('Event: node-hover', node);
    });
    orb.events.on('edge-click', (edge) => {
      console.log('Event: edge-click', edge);
    });

    setTimeout(() => {
      console.log("Now rendering as map!")
      orb.setView((context) => new Orb.MapView(context));
      orb.view.render();
    }, 5000);
  </script>
</body>
</html>